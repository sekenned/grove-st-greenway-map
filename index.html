Done ‚Äî on **mobile only** (‚â§ 640px), the Layers/Legend panel will start **collapsed**, while on desktop it starts open.

Here‚Äôs the updated full `index.html` (only change is: the control gets `collapsed` class on mobile at creation time):

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grove Street Greenway Map</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    :root {
      /* Grove + friends */
      --grove-green: #2ca25f;
      --grove-green-proposed: #1b7a3a; /* darker green for Elm/Orange option */
      --grove-green-halo: #c7e9c0;

      --accent-orange: #f97316;    /* transit */
      --accent-red: #e31a1c;       /* hospital */
      --accent-purple: #6a3d9a;    /* all POIs (incl. grocery + library) */
      --accent-teal: #1f9fb5;      /* regional lines */
      --accent-yellow: #f6c915;    /* Lenape yellow */
      --schools-blue: #1d4ed8;     /* Montclair royal blue */

      --text-muted: #555555;
      --border-soft: #e2e8f0;
      --bg: #ffffff;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: #111827;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      padding: 1.25rem 1.5rem 0.75rem;
      border-bottom: 1px solid var(--border-soft);
    }

    header h1 {
      margin: 0;
      font-size: 1.3rem;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    header p {
      margin: 0.35rem 0 0;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    #map-container {
      flex: 1;
      padding: 0.75rem 1.5rem 1.25rem;
    }

    #map {
      width: 100%;
      height: calc(100vh - 100px);
      max-width: 1200px;
      margin: 0 auto;
      border-radius: 18px;
      border: 1px solid var(--border-soft);
      box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
      overflow: hidden;
      position: relative;
    }

    .leaflet-popup-content {
      margin: 0.2rem 0;
      font-size: 0.85rem;
      line-height: 1.3;
    }
    .leaflet-popup-content h3 {
      margin: 0 0 0.15rem;
      font-size: 0.95rem;
      font-weight: 600;
    }
    .leaflet-popup-content p { margin: 0.1rem 0; }

    /* Combined Layers + Legend control */
    .layers-legend-control {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      box-shadow: 0 4px 16px rgba(15, 23, 42, 0.12);
      padding: 0.5rem 0.75rem 0.35rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      backdrop-filter: blur(4px);
      min-width: 230px;
    }

    .layers-legend-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.25rem;
      cursor: pointer;
      user-select: none;
    }

    .layers-legend-title {
      font-weight: 600;
      font-size: 0.8rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #0f172a;
    }

    .layers-legend-toggle-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: #4b5563;
      background: #ffffff;
    }

    .layers-legend-body { margin-top: 0.25rem; }
    .layers-legend-control.collapsed .layers-legend-body { display: none; }

    .layer-section-label {
      margin: 0.35rem 0 0.15rem;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #6b7280;
    }

    .layer-row {
      display: flex;
      align-items: center;
      gap: 0.45rem;
      margin: 0.18rem 0;
      line-height: 1.2;
    }

    .layer-row input[type="checkbox"] {
      width: 14px;
      height: 14px;
      margin: 0;
      cursor: pointer;
    }

    .layer-symbol { flex: 0 0 auto; }

    .layer-label {
      flex: 1 1 auto;
      font-size: 0.82rem;
      color: #111827;
    }

    .layer-symbol-line {
      width: 28px;
      height: 3px;
      border-radius: 999px;
      background: #999;
      position: relative;
    }

    .line-grove-main { background: var(--grove-green); }
    .line-grove-elm { background: var(--grove-green); opacity: 0.75; }
    .line-teal { background: var(--accent-teal); }
    .line-yellow { background: var(--accent-yellow); }

    /* Simple dashed treatment using repeating background */
    .is-dashed {
      background: repeating-linear-gradient(
        to right,
        currentColor 0,
        currentColor 8px,
        transparent 8px,
        transparent 14px
      );
      color: rgba(15, 23, 42, 0.35);
    }
    .is-dashed.line-teal { color: rgba(31, 159, 181, 0.9); }
    .is-dashed.line-yellow { color: rgba(246, 201, 21, 0.95); }

    .layer-symbol-dot {
      width: 11px;
      height: 11px;
      border-radius: 999px;
    }
    .dot-transit { background: var(--accent-orange); }
    .dot-poi { background: var(--accent-purple); }
    .dot-park { background: var(--grove-green); }
    .dot-school { background: var(--schools-blue); }
    .dot-hospital { background: var(--accent-red); }

    /* Custom vector marker styling (for map markers) */
    .custom-marker {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(15, 23, 42, 0.2);
      border: 1px solid var(--border-soft);
    }
    .custom-marker svg { width: 18px; height: 18px; display: block; }

    .custom-marker-park { color: var(--grove-green); }
    .custom-marker-school { color: var(--schools-blue); }
    .custom-marker-transit { color: var(--accent-orange); }
    .custom-marker-hospital { color: var(--accent-red); }
    .custom-marker-grocery { color: var(--accent-purple); }
    .custom-marker-library { color: var(--accent-purple); }

    /* ---------------- Mobile upgrades ---------------- */
    @media (max-width: 640px) {
      header { padding: 0.9rem 1rem 0.6rem; }
      #map-container { padding: 0; }

      /* Full-bleed map on mobile */
      #map {
        height: calc(100vh - 86px);
        max-width: none;
        margin: 0;
        border-radius: 0;
        border-left: 0;
        border-right: 0;
      }

      /* Bigger Leaflet zoom buttons */
      .leaflet-control-zoom a {
        width: 42px;
        height: 42px;
        line-height: 42px;
        font-size: 20px;
      }

      /* Bigger popups */
      .leaflet-popup-content {
        font-size: 0.95rem;
        line-height: 1.35;
      }

      /* Bottom-sheet style layers/legend */
      .leaflet-top.leaflet-right {
        top: auto;
        right: 0;
        bottom: 0;
        left: 0;
        padding: 0;
        margin: 0;
      }

      .layers-legend-control {
        border-radius: 16px 16px 0 0;
        margin: 0;
        width: 100vw;
        min-width: 0;
        padding: 0.7rem 0.9rem 0.6rem;
        box-shadow: 0 -8px 28px rgba(15, 23, 42, 0.18);
      }

      .layers-legend-title { font-size: 0.85rem; }
      .layer-section-label { font-size: 0.78rem; margin-top: 0.55rem; }

      /* Bigger tap targets */
      .layer-row { gap: 0.55rem; margin: 0.35rem 0; }
      .layer-row input[type="checkbox"] { width: 18px; height: 18px; }
      .layer-label { font-size: 0.95rem; }

      /* Bigger legend symbols */
      .layer-symbol-line { width: 36px; height: 4px; }
      .layer-symbol-dot { width: 14px; height: 14px; }

      /* Bigger marker ‚Äúchips‚Äù */
      .custom-marker { width: 34px; height: 34px; }
      .custom-marker svg { width: 22px; height: 22px; }
    }
  </style>
</head>

<body>
  <header>
    <h1>Grove Street Greenway Map</h1>
    <p>Toggle each layer to explore the emerging active-transportation spine through Montclair.</p>
  </header>

  <div id="map-container">
    <div id="map"></div>
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    // ---------- Base map (Carto only; no toggle menu) ----------
    const lightBase = L.tileLayer(
      "https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",
      {
        attribution:
          '&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a>, &copy; CARTO',
        maxZoom: 19,
      }
    );

    const map = L.map("map", {
      center: [40.84, -74.20], // placeholder; will be overridden by bounds
      zoom: 13,
      layers: [lightBase],
      zoomControl: true,
    });

    // Custom panes for z-order of icons
    map.createPane("poiPane");
    map.getPane("poiPane").style.zIndex = 410;

    map.createPane("parksPane");
    map.getPane("parksPane").style.zIndex = 420;

    map.createPane("transitPane");
    map.getPane("transitPane").style.zIndex = 430;

    map.createPane("schoolsPane");
    map.getPane("schoolsPane").style.zIndex = 440;

    let overallBounds = L.latLngBounds();
    let groveBounds = L.latLngBounds(); // for Grove + Elm/Orange focus
    const overlayGroups = {}; // name -> L.LayerGroup

    // ---------- Helpers ----------
    function extendOverallBounds(layer) {
      try {
        const b = layer.getBounds ? layer.getBounds() : null;
        if (b && b.isValid()) overallBounds.extend(b);
      } catch (e) {}
    }

    function extendGroveBounds(layer) {
      try {
        const b = layer.getBounds ? layer.getBounds() : null;
        if (b && b.isValid()) groveBounds.extend(b);
      } catch (e) {}
    }

    function bindBasicPopup(feature, layer, fallbackTitle) {
      const props = feature.properties || {};
      const title = props.name || fallbackTitle || "Feature";
      const address = props.address;
      const notes = props.notes || props.description || "";

      let html = `<h3>${title}</h3>`;
      if (address) html += `<p>${address}</p>`;
      if (notes) html += `<p>${notes}</p>`;
      layer.bindPopup(html);
    }

    function setLayerVisibility(name, visible) {
      const group = overlayGroups[name];
      if (!group) return;
      if (visible) map.addLayer(group);
      else map.removeLayer(group);
    }

    // ---------- SVG marker icons ----------
    const parkIcon = L.divIcon({
      className: "",
      html: `
        <div class="custom-marker custom-marker-park">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <rect x="10.5" y="12" width="3" height="7" rx="1" ry="1" fill="currentColor" />
            <circle cx="12" cy="10" r="4.5" fill="currentColor" />
            <circle cx="9" cy="10.5" r="3" fill="currentColor" />
            <circle cx="15" cy="10.5" r="3" fill="currentColor" />
          </svg>
        </div>
      `,
      iconSize: [26, 26],
      iconAnchor: [13, 13],
      popupAnchor: [0, -13],
    });

    const schoolIcon = L.divIcon({
      className: "",
      html: `
        <div class="custom-marker custom-marker-school">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <polygon points="6,11 12,5 18,11" fill="currentColor" />
            <rect x="5" y="11" width="3" height="7" fill="currentColor" />
            <rect x="16" y="11" width="3" height="7" fill="currentColor" />
            <rect x="10" y="10" width="4" height="9" fill="currentColor" />
            <circle cx="12" cy="12.4" r="1.4" fill="#ffffff" />
            <line x1="12" y1="12.4" x2="12" y2="11.3"
                  stroke="currentColor" stroke-width="0.7" stroke-linecap="round" />
            <line x1="12" y1="12.4" x2="13.1" y2="12.4"
                  stroke="currentColor" stroke-width="0.7" stroke-linecap="round" />
            <rect x="11.1" y="15" width="1.8" height="4" fill="#ffffff" rx="0.5" />
            <rect x="5.3"  y="12.5" width="2.4" height="1.4" fill="#ffffff" opacity="0.85" />
            <rect x="16.3" y="12.5" width="2.4" height="1.4" fill="#ffffff" opacity="0.85" />
          </svg>
        </div>
      `,
      iconSize: [26, 26],
      iconAnchor: [13, 13],
      popupAnchor: [0, -13],
    });

    const transitIcon = L.divIcon({
      className: "",
      html: `
        <div class="custom-marker custom-marker-transit">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <rect x="5" y="5" width="14" height="11" rx="2" ry="2" fill="currentColor" />
            <rect x="7" y="7" width="4" height="3" fill="#ffffff" />
            <rect x="13" y="7" width="4" height="3" fill="#ffffff" />
            <rect x="9" y="11" width="6" height="2" fill="#ffffff" />
            <line x1="7" y1="18" x2="11" y2="21" stroke="currentColor" stroke-width="1.5" />
            <line x1="17" y1="18" x2="13" y2="21" stroke="currentColor" stroke-width="1.5" />
          </svg>
        </div>
      `,
      iconSize: [26, 26],
      iconAnchor: [13, 13],
      popupAnchor: [0, -13],
    });

    const hospitalIcon = L.divIcon({
      className: "",
      html: `
        <div class="custom-marker custom-marker-hospital">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <rect x="10" y="4" width="4" height="16" fill="currentColor" />
            <rect x="4" y="10" width="16" height="4" fill="currentColor" />
          </svg>
        </div>
      `,
      iconSize: [26, 26],
      iconAnchor: [13, 13],
      popupAnchor: [0, -13],
    });

    const groceryIcon = L.divIcon({
      className: "",
      html: `
        <div class="custom-marker custom-marker-grocery">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <rect x="6" y="9" width="11" height="6" rx="1" ry="1" fill="currentColor" />
            <line x1="6" y1="9" x2="4" y2="5" stroke="currentColor" stroke-width="1.5" />
            <circle cx="9" cy="17" r="1.5" fill="currentColor" />
            <circle cx="15" cy="17" r="1.5" fill="currentColor" />
          </svg>
        </div>
      `,
      iconSize: [26, 26],
      iconAnchor: [13, 13],
      popupAnchor: [0, -13],
    });

    const libraryIcon = L.divIcon({
      className: "",
      html: `
        <div class="custom-marker custom-marker-library">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <rect x="6" y="5" width="6" height="14" rx="1" ry="1" fill="currentColor" />
            <rect x="7" y="6" width="4" height="12" fill="#ffffff" opacity="0.8" />
            <rect x="12" y="7" width="5" height="12" rx="1" ry="1"
                  fill="currentColor" opacity="0.85" />
          </svg>
        </div>
      `,
      iconSize: [26, 26],
      iconAnchor: [13, 13],
      popupAnchor: [0, -13],
    });

    // ---------- Point layer renderers ----------
    function poiPointToLayer(feature, latlng) {
      const props = feature.properties || {};
      const cat = (props.category || "").toLowerCase();

      if (cat === "hospital") return L.marker(latlng, { icon: hospitalIcon, pane: "poiPane" });
      if (cat === "grocery")  return L.marker(latlng, { icon: groceryIcon, pane: "poiPane" });
      if (cat === "library")  return L.marker(latlng, { icon: libraryIcon, pane: "poiPane" });

      const fill = (getComputedStyle(document.documentElement).getPropertyValue("--accent-purple") || "#6a3d9a").trim();
      return L.circleMarker(latlng, {
        pane: "poiPane",
        radius: 7,
        weight: 1.5,
        color: "#ffffff",
        fillColor: fill,
        fillOpacity: 0.95,
      });
    }

    function poiOnEachFeature(feature, layer) {
      const props = feature.properties || {};
      const cat = (props.category || "").toLowerCase();
      let emoji = "üìç";
      if (cat === "grocery") emoji = "üõí";
      else if (cat === "library") emoji = "üìö";
      else if (cat === "hospital") emoji = "üè•";
      else if (cat === "mixed-use") emoji = "üèôÔ∏è";

      const title = `${emoji} ${props.name || "Point of Interest"}`;
      const address = props.address;
      const notes = props.notes || "";
      let html = `<h3>${title}</h3>`;
      if (address) html += `<p>${address}</p>`;
      if (notes) html += `<p>${notes}</p>`;
      layer.bindPopup(html);
    }

    function parkPointToLayer(feature, latlng) {
      return L.marker(latlng, { icon: parkIcon, pane: "parksPane" });
    }
    function parkOnEachFeature(feature, layer) {
      const props = feature.properties || {};
      const title = `üå≥ ${props.name || "Park"}`;
      const address = props.address;
      const notes = props.notes || props.entrance_description || "";
      let html = `<h3>${title}</h3>`;
      if (address) html += `<p>${address}</p>`;
      if (notes) html += `<p>${notes}</p>`;
      layer.bindPopup(html);
    }

    function schoolPointToLayer(feature, latlng) {
      return L.marker(latlng, { icon: schoolIcon, pane: "schoolsPane" });
    }
    function schoolOnEachFeature(feature, layer) {
      const props = feature.properties || {};
      const title = `üè´ ${props.name || "School"}`;
      const address = props.address;
      const level = props.level;
      const grades = props.grades;
      const notes = props.notes || "";
      let html = `<h3>${title}</h3>`;
      if (address) html += `<p>${address}</p>`;
      if (level || grades) html += `<p>${[level, grades].filter(Boolean).join(" ‚Ä¢ ")}</p>`;
      if (notes) html += `<p>${notes}</p>`;
      layer.bindPopup(html);
    }

    function transitPointToLayer(feature, latlng) {
      return L.marker(latlng, { icon: transitIcon, pane: "transitPane" });
    }
    function transitOnEachFeature(feature, layer) {
      const props = feature.properties || {};
      const mode = (props.mode || "").toLowerCase();
      const line = props.line;
      let emoji = "üöÜ";
      if (mode.includes("bus")) emoji = "üöå";
      if (mode.includes("light_rail")) emoji = "üöà";
      const title = `${emoji} ${props.name || "Transit stop"}`;
      const address = props.address;
      const notes = props.notes || "";
      let html = `<h3>${title}</h3>`;
      if (line) html += `<p>${line}</p>`;
      if (address) html += `<p>${address}</p>`;
      if (notes) html += `<p>${notes}</p>`;
      layer.bindPopup(html);
    }

    function makeLineStyle(color, weight, dashArray, opacity) {
      return { color, weight, dashArray: dashArray || null, opacity: opacity ?? 0.9 };
    }

    // ---------- Layer configuration ----------
    const layerConfigs = [
      { name: "Grove Street Greenway", file: "grove-street-greenway.geojson", kind: "grove", defaultOn: true },
      { name: "Elm + Orange Extension (South End Connector)", file: "MTC_Orang-Elm-Extension.geojson", kind: "grove", defaultOn: true },

      { name: "Essex‚ÄìHudson Greenway", file: "essex-hudson-greenway.geojson", kind: "line",
        colorVariable: "--accent-teal", fallbackColor: "#1f9fb5", weight: 4, defaultOn: true },

      { name: "Lenape Trail", file: "Lenape-trail.geojson", kind: "line",
        colorVariable: "--accent-yellow", fallbackColor: "#f6c915", weight: 3, dashArray: "6 4", defaultOn: false },

      { name: "Morris Canal Greenway (Proposed)", file: "Morris-Canal.geojson", kind: "line",
        colorVariable: "--accent-teal", fallbackColor: "#1f9fb5", weight: 3, dashArray: "4 4", defaultOn: false },

      { name: "Montclair Transit Hubs", file: "montclair_transit.geojson", kind: "transit", defaultOn: true },
      { name: "Montclair Parks", file: "mtc-parks.geojson", kind: "parks", defaultOn: true },
      { name: "Montclair Schools", file: "mtc_schools.geojson", kind: "schools", defaultOn: true },
      { name: "Montclair Points of Interest", file: "mtc-points-of-interest.geojson", kind: "poi", defaultOn: true }
    ];

    // Pre-create groups + set defaults
    layerConfigs.forEach(cfg => {
      overlayGroups[cfg.name] = L.layerGroup();
      if (cfg.defaultOn) overlayGroups[cfg.name].addTo(map);
    });

    // ---------- Combined Layers + Legend Control (collapsed on mobile only) ----------
    const LayersLegendControl = L.Control.extend({
      options: { position: "topright" },
      onAdd: function() {
        const container = L.DomUtil.create("div", "layers-legend-control leaflet-bar");

        // ‚úÖ NEW: start collapsed on mobile only
        const isMobile = window.matchMedia("(max-width: 640px)").matches;
        if (isMobile) container.classList.add("collapsed");

        const header = L.DomUtil.create("div", "layers-legend-header", container);
        const title = L.DomUtil.create("div", "layers-legend-title", header);
        title.textContent = "Layers & Legend";

        const icon = L.DomUtil.create("div", "layers-legend-toggle-icon", header);
        icon.innerHTML = "‚ò∞";

        const body = L.DomUtil.create("div", "layers-legend-body", container);

        L.DomEvent.disableClickPropagation(container);
        L.DomEvent.disableScrollPropagation(container);

        const addRow = (layerName, symbolElClass, labelText) => {
          const row = L.DomUtil.create("label", "layer-row", body);
          const input = L.DomUtil.create("input", "", row);
          input.type = "checkbox";
          input.checked = !!layerConfigs.find(c => c.name === layerName)?.defaultOn;
          input.dataset.layerName = layerName;

          L.DomUtil.create("span", "layer-symbol " + symbolElClass, row);
          const labelSpan = L.DomUtil.create("span", "layer-label", row);
          labelSpan.textContent = labelText;

          input.addEventListener("change", (e) => {
            setLayerVisibility(layerName, e.target.checked);
          });
        };

        // Network
        const net = L.DomUtil.create("div", "layer-section-label", body);
        net.textContent = "Network";
        addRow("Grove Street Greenway", "layer-symbol-line line-grove-main", "Grove Greenway");
        addRow("Elm + Orange Extension (South End Connector)", "layer-symbol-line line-grove-elm", "Elm/Orange (concept)");
        addRow("Essex‚ÄìHudson Greenway", "layer-symbol-line line-teal", "Essex‚ÄìHudson Greenway");
        addRow("Lenape Trail", "layer-symbol-line line-yellow is-dashed", "Lenape Trail");
        addRow("Morris Canal Greenway (Proposed)", "layer-symbol-line line-teal is-dashed", "Morris Canal (proposed)");

        // Places
        const places = L.DomUtil.create("div", "layer-section-label", body);
        places.textContent = "Places";
        addRow("Montclair Transit Hubs", "layer-symbol-dot dot-transit", "Transit hubs");
        addRow("Montclair Parks", "layer-symbol-dot dot-park", "Parks");
        addRow("Montclair Schools", "layer-symbol-dot dot-school", "Schools");
        addRow("Montclair Points of Interest", "layer-symbol-dot dot-poi", "Points of interest (incl. grocery)");

        // Collapse/expand via header
        header.addEventListener("click", () => {
          container.classList.toggle("collapsed");
        });

        return container;
      }
    });

    map.addControl(new LayersLegendControl());

    // ---------- Load layers ----------
    const promises = [];

    layerConfigs.forEach((cfg) => {
      const group = overlayGroups[cfg.name];

      const p = fetch(cfg.file)
        .then(resp => resp.json())
        .then(geojson => {
          if (cfg.kind === "grove") {
            const styles = getComputedStyle(document.documentElement);
            const groveGreen = (styles.getPropertyValue("--grove-green").trim() || "#2ca25f");
            const groveGreenProposed = (styles.getPropertyValue("--grove-green-proposed").trim() || "#1b7a3a");
            const haloColor = (styles.getPropertyValue("--grove-green-halo").trim() || "#c7e9c0");

            const isElmOrange = cfg.name.includes("Elm + Orange");
            const coreColor = isElmOrange ? groveGreenProposed : groveGreen;

            const isMobile = window.matchMedia("(max-width: 640px)").matches;
            const coreOpacity = isElmOrange ? 0.75 : 0.95;
            const haloOpacity = isElmOrange ? 0.45 : 0.55;

            const haloWeight = isMobile ? (isElmOrange ? 10 : 12) : (isElmOrange ? 8 : 10);
            const coreWeight = isMobile ? 7 : 6;

            const haloLayer = L.geoJSON(geojson, {
              filter: f => f.geometry && (f.geometry.type === "LineString" || f.geometry.type === "MultiLineString"),
              style: { color: haloColor, weight: haloWeight, opacity: haloOpacity }
            });

            const coreLayer = L.geoJSON(geojson, {
              filter: f => f.geometry && (f.geometry.type === "LineString" || f.geometry.type === "MultiLineString"),
              style: { color: coreColor, weight: coreWeight, opacity: coreOpacity },
              onEachFeature: (feature, layer) => bindBasicPopup(feature, layer, cfg.name)
            });

            haloLayer.addTo(group);
            coreLayer.addTo(group);

            // Center on Grove + Elm/Orange together
            extendGroveBounds(coreLayer);
            extendOverallBounds(coreLayer);
            return;
          }

          if (cfg.kind === "line") {
            const colorVar = cfg.colorVariable
              ? getComputedStyle(document.documentElement).getPropertyValue(cfg.colorVariable)
              : "";
            const lineColor = (colorVar && colorVar.trim()) || cfg.fallbackColor || "#1f9fb5";

            const lineLayer = L.geoJSON(geojson, {
              style: () => makeLineStyle(lineColor, cfg.weight || 3, cfg.dashArray, 0.9),
              onEachFeature: (feature, layer) => bindBasicPopup(feature, layer, cfg.name),
            }).addTo(group);

            extendOverallBounds(lineLayer);
            return;
          }

          let opts = {};
          if (cfg.kind === "poi") opts = { pointToLayer: poiPointToLayer, onEachFeature: poiOnEachFeature };
          else if (cfg.kind === "parks") opts = { pointToLayer: parkPointToLayer, onEachFeature: parkOnEachFeature };
          else if (cfg.kind === "schools") opts = { pointToLayer: schoolPointToLayer, onEachFeature: schoolOnEachFeature };
          else if (cfg.kind === "transit") opts = { pointToLayer: transitPointToLayer, onEachFeature: transitOnEachFeature };

          const layer = L.geoJSON(geojson, opts).addTo(group);
          extendOverallBounds(layer);
        })
        .catch(err => console.error(`Failed to load ${cfg.file}`, err));

      promises.push(p);
    });

    Promise.all(promises).then(() => {
      if (groveBounds.isValid()) map.fitBounds(groveBounds.pad(0.10));
      else if (overallBounds.isValid()) map.fitBounds(overallBounds.pad(0.08));
    });

    // Local testing:
    // python -m http.server 8000
  </script>
</body>
</html>
```
